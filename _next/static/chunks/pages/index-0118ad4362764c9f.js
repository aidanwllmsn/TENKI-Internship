(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5557:function(e,t,i){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return i(4107)}])},4107:function(e,t,i){"use strict";i.r(t),i.d(t,{default:function(){return m}});var n=i(5893),r=i(9008),s=i.n(r),o=i(7294),a=i(1163),l=i(3205);let d=e=>{let t=(0,o.useRef)(null);return(0,o.useEffect)(()=>{!e&&t.current&&(t.current(),t.current=null)},[e]),()=>new Promise(i=>{e?t.current=i:i()})};var c=i(4409),h=i.n(c),u=i(7460),f=i.n(u),p=e=>{let{htmlContent:t,width:i,height:r}=e;return(0,n.jsx)("div",{style:{width:i,height:r,border:"none"},dangerouslySetInnerHTML:{__html:t}})};function m(){let{pageState:e,setPageState:t,isProcessed:i,setIsProcessed:r,isLoading:c,setIsLoading:u,listing:m,setListing:g}=(0,l.l)(),[_,y]=(0,o.useState)(e||[]),[v,x]=(0,o.useState)([]),[w,b]=(0,o.useState)("Analyzing"),[k,E]=(0,o.useState)("Generating option 1"),[R,C]=(0,o.useState)(!1),[S,T]=(0,o.useState)(!1),[O,I]=(0,o.useState)([]),A=d(c),[N,j]=(0,o.useState)([]),[D,L]=(0,o.useState)([]),[F,z]=(0,o.useState)(0),[B,M]=(0,o.useState)([]),[P,U]=(0,o.useState)(_.map(()=>!1));(0,o.useEffect)(()=>{i||0!==N.length||fetch("/data/glv-sample2.csv").then(e=>e.text()).then(e=>{f().parse(e,{header:!0,dynamicTyping:!0,chunk:function(e){j(t=>[...t,...e.data]),e.errors.length&&console.error("Error parsing CSV:",e.errors)},complete:function(){}})}).catch(e=>{console.error("Error reading CSV:",e)})},[i,N]),(0,o.useEffect)(()=>{N.length>0&&0===D.length&&K(N,0)},[N]),(0,o.useEffect)(()=>{if(D.length>0){let e=D.map(e=>{let t='Instructions for Optimizing Keywords for Rakuten Listings:\n\nObjective: Enhance search visibility and relevance of Rakuten listings through strategic keyword optimization, aligning with customer search behaviors and Rakuten\'s platform standards. The goal is to meticulously analyze and optimize the listing to attract a broader audience by leveraging a comprehensive set of keywords.\n\n\n1. Comprehensive Review of Listing Elements:\nInitial Analysis: Start by examining the list of initial keywords, the product title, catch copy, and the product description. This review is essential for understanding the product’s key features and unique selling propositions.\n\n2. Strategic Generation of "関連キーワード" (Related Keywords):\n- Expansion with Synonyms and Related Terms: Use the initial keywords as a base and methodically expand this list by incorporating synonyms and related terms. Focus on including terms that highlight product specifications (size, material, color, age suitability) and any unique features or benefits not directly mentioned in the initial list.\n- Explicit Synonym Inclusion: It is important to add synonyms for key attributes and related terms that potential customers might use in their search queries. This step is vital for capturing a wide range of customer intents.\n\n3. Detailed Keyword Categorization for Precision:\n- Ignored Keywords Because Not in Content: Identify and list any provided keywords not directly referenced or implied in the product description, marking "N/A" if none apply.\n- Used from List Although Not Directly in Content: Document the keywords from the initial list that have been included in the 関連キーワード (related keywords) section despite not appearing in the product\'s title, catch copy, or description. Indicate "N/A" if not applicable.\n- Inclusion of Synonyms/Similar Terms: Actively seek and list additional synonyms or closely related terms derived from the product content that were not part of the initial keyword set. This step is crucial for broadening the search visibility of the listing.\n\n4. Ensure Coherence, Relevance, and Platform Compliance:\nEnsure all keywords and categorized lists are presented clearly and cohesively, adhering to Rakuten\'s preferred formatting. All terms must be directly relevant and accurately reflect the product to enhance searchability and meet Rakuten’s SEO standards.\n\n5. Formatting:\n- Result should include 4 sections:\n関連キーワード: (bold)\nfollowed by list (keywords separated by space)\n\n- Ignored Keywords Because Not in Content\n- Used from List Although Not Directly in Content\n- Inclusion of Synonyms/Similar Terms\neach one of 3 above is followed by list of keywords, one per line (or N/A).\n\n- No Explanatory Text: Exclude any form of explanatory text before, within, or after the listing of requested results. The response should be limited strictly to the output or data requested.\n- Adhere to Requested Structure: Follow the structure requested for the response meticulously. If the request specifies a list, provide only the list in the format and order requested without deviation.\n- Clear and Concise: Keep all listings clear, concise, and directly relevant to the instructions given. Unnecessary elaboration or deviation from the requested format is to be avoided.\n\n6. Final Review for Comprehensive Coverage and Strategic Alignment:\n- Conduct a thorough review to ensure the keyword list is exhaustive and aligns with the strategic objective of maximizing search visibility on Rakuten. This includes a final check for completeness, relevance, and adherence to Rakuten’s SEO best practices.\n- Ensure that keywords incorporated into the 関連キーワード section are accurately identified as either directly mentioned in the listing content (title, catch copy, product description) or included based on their relevance to the product, without direct mention within the main text. to summarize, process should be:\nInitial Keyword Review: "Start by reviewing the provided keywords. Determine their direct relevance to the product by checking if they or their close derivatives appear in the product title, catch copy, or description."\n\nGenerating Related Keywords: "Expand the initial keyword list by adding synonyms and related terms. Include only those terms that are directly associated with the product’s features, benefits, or use cases. Avoid adding general terms that are not specific to the product."\n\nCategorization of Keywords:"List any keywords from the provided list that are not found in the product\'s title, catch copy, or description under \'Ignored Keywords Because Not in Content.\'"\n"For \'Used from List Although Not Directly in Content,\' include keywords that, while not explicitly mentioned, are closely related to the product\'s features or benefits and have been included in the related keywords section."\n"Under \'Inclusion of Synonyms/Similar Terms,\' list additional relevant terms derived from the listing content that expand the search visibility but were not included in the initial set."\n\nFinal Check for Alignment and Relevance: EXTREMELY IMPORTANT "Review the keyword lists to ensure they are exhaustive, relevant, and aligned with strategic objectives for maximizing search visibility. Adjust as necessary for coherence and compliance with Rakuten’s standards."\n\nProvide the answer in this exact format "関連キーワード: {新しい関連キーワード}. End of Instructions Item: https://item.rakuten.co.jp/'.concat(e.shop_id_url,"/").concat(e.item_id_url,"/, ID: ").concat(e.item_id_url,", Keywords: ").concat(Object.values(e).slice(9).join(" "),", title: ").concat(e.ftp_title,", content: ").concat(e.ftp_desc_pc);g(t=>[...t,"".concat(e.ftp_desc_pc)]);let i="https://item.rakuten.co.jp/".concat(e.shop_id_url,"/").concat(e.item_id_url,"/");return M(e=>[...e,i]),t});I(e),q(e)}},[D]);let K=(e,t)=>{let i=e.slice(t,t+3);L(i),z(t+i.length)};(0,o.useEffect)(()=>{0===_.length&&i&&(u(!0),r(!1),K(N,F))},[_,i]);let q=async e=>{for(let t of e)E("Generating option 1"),u(!0),await Y(t.trim()),await A();r(!0)},H=(0,a.useRouter)();(0,o.useEffect)(()=>{if(R||S){let e=setTimeout(()=>{C(!1),T(!1)},2e3);return()=>clearTimeout(e)}},[R,S]),(0,o.useEffect)(()=>{if(c){let e=setInterval(()=>{b(e=>"Analyzing"===e?"Analyzing.":"Analyzing."===e?"Analyzing..":"Analyzing.."===e?"Analyzing...":"Analyzing")},250);return()=>clearInterval(e)}},[c]);let W=(e,t,i)=>{let n=e;return t.forEach(e=>{let t=RegExp("(".concat(e,")"),"gi");n=n.replace(t,'<span class="'.concat(h().highlightRed,'">$1</span>'))}),i.forEach(e=>{let t=RegExp("(".concat(e,")"),"gi");n=n.replace(t,'<span class="'.concat(h().highlightYellow,'">$1</span>'))}),n},G=["Using the same structure and process as described in the previous instructions, please provide a keyword optimization analysis for a Rakuten listing. Assume the listing is similar to the one previously discussed but with different results. Do not include any specific details such as item URL, title, or catch copy. Please follow these steps: 関連キーワード: List a comprehensive set of related keywords that could enhance search visibility for a product similar to the one discussed. Ignored Keywords Because Not in Content: List any keywords from the provided set that are not directly referenced or implied in the product content. Used from List Although Not Directly in Content: Document keywords from the initial list that, while not explicitly mentioned in the products content, are closely related to the product and included in the related keywords section. Inclusion of Synonyms/Similar Terms: Provide additional synonyms or closely related terms derived from the product content to broaden search visibility. Ensure that the response adheres to the same structure and format as the previous response and is clear, concise, and directly relevant. Format it exaclty as such '関連キーワード:'","Using the same structure and process as described in the previous instructions, please provide a keyword optimization analysis for a Rakuten listing. Assume the listing is similar to the one previously discussed but with different results. Do not include any specific details such as item URL, title, or catch copy. Please follow these steps: 関連キーワード: List a comprehensive set of related keywords that could enhance search visibility for a product similar to the one discussed. Ignored Keywords Because Not in Content: List any keywords from the provided set that are not directly referenced or implied in the product content. Used from List Although Not Directly in Content: Document keywords from the initial list that, while not explicitly mentioned in the products content, are closely related to the product and included in the related keywords section. Inclusion of Synonyms/Similar Terms: Provide additional synonyms or closely related terms derived from the product content to broaden search visibility. Ensure that the response adheres to the same structure and format as the previous response and is clear, concise, and directly relevant. MAKE SURE THE RESPONSE IS DIFFERENT FROM THE PREVIOUS ONE. Format it exaclty as such '関連キーワード:'","Using the same structure and process as described in the previous instructions, please provide a keyword optimization analysis for a Rakuten listing. Assume the listing is similar to the one previously discussed but combine the results from the previous two responses. Do not include any specific details such as item URL, title, or catch copy. Please follow these steps: 関連キーワード: List a comprehensive set of related keywords that could enhance search visibility for a product similar to the one discussed. Ignored Keywords Because Not in Content: List any keywords from the provided set that are not directly referenced or implied in the product content. Used from List Although Not Directly in Content: Document keywords from the initial list that, while not explicitly mentioned in the products content, are closely related to the product and included in the related keywords section. Inclusion of Synonyms/Similar Terms: Provide additional synonyms or closely related terms derived from the product content to broaden search visibility. Ensure that the response adheres to the same structure and format as the previous response and is clear, concise, and directly relevant. Format it exaclty as such '関連キーワード:'","From the previous 3 responses. Can you provide a score for each out of 10 based on how well they would perform on Rakuten based off maximizing search visibility. Format it exactly like this: Option 1: score, Option 2: score, Option 3: score"],J=0,Q=[],X=[],Y=async e=>{y(e=>[...e]);let t=await fetch("/api/generate?endpoint=chat",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:e})});console.log(e);let i=await t.json();if(i.success){let e=new EventSource("/api/generate?endpoint=stream"),t="";e.onmessage=function(i){let n=JSON.parse(i.data);if(n.end_of_stream){console.log(t=t.replace(/- /g,"")),console.log(J),e.close();let i=t.split("\n\n"),n=i[0],r="";J<5&&(r=(r=(r=(r=(r=(r=(r=(r=(r=i.slice(1).join("<br><br>")).split(": \n")).join("<br>")).split("\n")).join("<br>")).split(", ")).join("<br>")).split(": ")).join("<br>"));let s=n.replace("関連キーワード: ","").replace(/,/g,"");if(s=s.replace(/ /g,"\n"),J<5){let e="Used from List Although Not Directly in Content",i="Inclusion of Synonyms/Similar Terms",n=t.indexOf(e)+e.length,r=t.indexOf(i);Q=t.substring(n,r).trim().split("\n").map(e=>e.trim()).filter(e=>e);let s=t.indexOf(i)+i.length;X=t.substring(s).trim().split("\n").map(e=>e.trim()).filter(e=>e)}let o=W(s,Q,X);r=o+"<br><br>"+r,y(e=>{let t=[...e];return 2===J?(E("Generating option 2"),t.push({role:"options",content:o,info:r,noHighlight:s})):0===J?(E("Generating option 1"),J+=1):3===J?(E("Generating option 3"),t.push({role:"options",content:o,info:r,noHighlight:s})):4===J?(E("Generating score."),J+=1,t.push({role:"options",content:o,info:r,noHighlight:s})):5===J&&(t.push({role:"score",content:o,info:r,noHighlight:s}),J=0,u(!1)),t}),J<4&&Y(G[(J+=1)-1])}else t+=n},e.onopen=()=>console.log("Connection to stream opened"),e.onerror=function(){e.close()}}},$=async()=>{if(c){T(!0);return}t(_),H.push("/items")},Z=e=>{let t=_[e].role,i=e,n=e;for(;i>0&&_[i-1].role===t;)i--;for(;n<_.length-1&&_[n+1].role===t;)n++;return n<_.length-1&&"score"===_[n+1].role&&n++,{start:i,end:n}},V=async(e,t)=>{if("score"===_[t].role){ee(t);return}if(!c)try{let i=await fetch("/api/addItem",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e})}),n=await i.json();if(n.success){x([...v,n.data]);let{start:e,end:i}=Z(t),r=_.filter((t,n)=>n<e||n>i);g(e=>e.slice(1)),M(e=>e.slice(1));let s=P.slice(4);U(s),y(r),C(!0)}else alert("Failed to add item.")}catch(e){console.error("Error:",e),alert("Failed to add item.")}},ee=e=>{let t=[...P];t[e-3]=!t[e-3],t[e-2]=!t[e-2],t[e-1]=!t[e-1],U(t)};return(0,n.jsxs)("div",{className:h().body,children:[(0,n.jsx)(s(),{children:(0,n.jsx)("title",{children:"TENKI Keyword Optimizer"})}),(0,n.jsxs)("div",{className:h().header,children:[(0,n.jsx)("h1",{className:h().heading1,children:"TENKI-JAPAN Keyword Optimizer"}),(0,n.jsxs)("div",{className:h().buttonGroup,children:[(0,n.jsx)("button",{className:h().dataButton,type:"button",onClick:$,children:"Saved Keywords"}),(0,n.jsx)("a",{href:B[0],className:h().dataButton,target:"_blank",rel:"noopener noreferrer",children:"See Listing"})]})]}),(0,n.jsxs)("div",{className:h().pageContainer,children:[(0,n.jsx)("div",{className:h().leftTextBox,children:(0,n.jsx)("div",{children:(0,n.jsx)(p,{htmlContent:m[0],width:"100%",height:"100vh"})})}),(0,n.jsxs)("div",{className:h().chatContainer,children:[_.map((e,t)=>(0,n.jsxs)("div",{className:"score"===e.role?h().chatBox2:h().chatBox,children:[(0,n.jsx)("div",{className:"".concat("score"===e.role?h().scoreBox:""," ").concat(h().contentArea),children:(0,n.jsx)("div",{className:h().leftText,dangerouslySetInnerHTML:{__html:P[t]?e.info:e.content}})}),"score"!==e.role&&(0,n.jsx)("button",{onClick:()=>V(e.noHighlight,t),className:h().myButton,children:"Save"}),"score"===e.role&&(0,n.jsx)("button",{onClick:()=>V(e.noHighlight,t),className:h().myButton2,children:"Details"})]},t)),c&&(0,n.jsx)("p",{className:h().loadingText,children:w}),c&&(0,n.jsx)("p",{className:h().loadingTextsmall,children:k})]})]}),(0,n.jsx)("div",{className:"".concat(h().successMessage," ").concat(R?h().show:h().hide),children:"Successfully Saved"}),(0,n.jsx)("div",{className:"".concat(h().errorMessage," ").concat(S?h().show:h().hide),children:"Wait for Analysis to finish"})]})}},4409:function(e){e.exports={body:"index_body__qD8DH",input:"index_input__maqH_",icon:"index_icon__F8Jdf",h3:"index_h3__pfikQ",header:"index_header__MHF_t",buttonGroup:"index_buttonGroup__XP_9B",myButton:"index_myButton__B2qIL",myButton2:"index_myButton2__eYUAT",contentArea:"index_contentArea__X3q4z",dataButton:"index_dataButton__aWek0",listing:"index_listing__ev_GK",pageContainer:"index_pageContainer__o1EGV",leftTextBox:"index_leftTextBox__vlW_z",chatContainer:"index_chatContainer__FZ4yR",chatBox:"index_chatBox__BwIAM",highlightRed:"index_highlightRed__ByMf8",highlightYellow:"index_highlightYellow__D_6Ig",chatBox2:"index_chatBox2__nNA9F",scoreBox:"index_scoreBox___NOKs",leftText:"index_leftText__ELKUq",successMessage:"index_successMessage__lR4Bg",errorMessage:"index_errorMessage__5yzEc",show:"index_show__P4et4",hide:"index_hide__RQuIl",userMessage:"index_userMessage__FICEZ",assistantMessage:"index_assistantMessage__PdOKQ",messageInputContainer:"index_messageInputContainer__ggPxz",heading1:"index_heading1__J8_Cn",container:"index_container__Wxv5N",main:"index_main__a4FrX",title:"index_title__Hhl0T",tableContainer:"index_tableContainer__7xJpd",table:"index_table__3NOK_",form:"index_form__HOPNU",textarea:"index_textarea__AmJE7",inputSubmit:"index_inputSubmit__kZenR",inputButton:"index_inputButton__yuPfx",inputGen:"index_inputGen__a2ifB",inputText:"index_inputText___lCEF",loadingText:"index_loadingText__Aa7Oe",loadingTextsmall:"index_loadingTextsmall__XLoH0",placeholder:"index_placeholder__DKOMJ",result:"index_result__sMCW7"}},9008:function(e,t,i){e.exports=i(2636)},1163:function(e,t,i){e.exports=i(6885)},7460:function(e,t){var i,n;void 0!==(n="function"==typeof(i=function e(){"use strict";var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==t?t:{},i=!t.document&&!!t.postMessage,n=t.IS_PAPA_WORKER||!1,r={},s=0,o={parse:function(i,n){var a,l=(n=n||{}).dynamicTyping||!1;if(w(l)&&(n.dynamicTypingFunction=l,l={}),n.dynamicTyping=l,n.transform=!!w(n.transform)&&n.transform,n.worker&&o.WORKERS_SUPPORTED){var f=function(){if(!o.WORKERS_SUPPORTED)return!1;var i,n,a=(i=t.URL||t.webkitURL||null,n=e.toString(),o.BLOB_URL||(o.BLOB_URL=i.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",n,")();"],{type:"text/javascript"})))),l=new t.Worker(a);return l.onmessage=g,l.id=s++,r[l.id]=l}();return f.userStep=n.step,f.userChunk=n.chunk,f.userComplete=n.complete,f.userError=n.error,n.step=w(n.step),n.chunk=w(n.chunk),n.complete=w(n.complete),n.error=w(n.error),delete n.worker,void f.postMessage({input:i,config:n,workerId:f.id})}var p=null;return o.NODE_STREAM_INPUT,"string"==typeof i?(i=65279===(a=i).charCodeAt(0)?a.slice(1):a,p=n.download?new d(n):new h(n)):!0===i.readable&&w(i.read)&&w(i.on)?p=new u(n):(t.File&&i instanceof File||i instanceof Object)&&(p=new c(n)),p.stream(i)},unparse:function(e,t){var i=!1,n=!0,r=",",s="\r\n",a='"',l=a+a,d=!1,c=null,h=!1;!function(){if("object"==typeof t){if("string"!=typeof t.delimiter||o.BAD_DELIMITERS.filter(function(e){return -1!==t.delimiter.indexOf(e)}).length||(r=t.delimiter),("boolean"==typeof t.quotes||"function"==typeof t.quotes||Array.isArray(t.quotes))&&(i=t.quotes),"boolean"!=typeof t.skipEmptyLines&&"string"!=typeof t.skipEmptyLines||(d=t.skipEmptyLines),"string"==typeof t.newline&&(s=t.newline),"string"==typeof t.quoteChar&&(a=t.quoteChar),"boolean"==typeof t.header&&(n=t.header),Array.isArray(t.columns)){if(0===t.columns.length)throw Error("Option columns is empty");c=t.columns}void 0!==t.escapeChar&&(l=t.escapeChar+a),("boolean"==typeof t.escapeFormulae||t.escapeFormulae instanceof RegExp)&&(h=t.escapeFormulae instanceof RegExp?t.escapeFormulae:/^[=+\-@\t\r].*$/)}}();var u=RegExp(p(a),"g");if("string"==typeof e&&(e=JSON.parse(e)),Array.isArray(e)){if(!e.length||Array.isArray(e[0]))return f(null,e,d);if("object"==typeof e[0])return f(c||Object.keys(e[0]),e,d)}else if("object"==typeof e)return"string"==typeof e.data&&(e.data=JSON.parse(e.data)),Array.isArray(e.data)&&(e.fields||(e.fields=e.meta&&e.meta.fields||c),e.fields||(e.fields=Array.isArray(e.data[0])?e.fields:"object"==typeof e.data[0]?Object.keys(e.data[0]):[]),Array.isArray(e.data[0])||"object"==typeof e.data[0]||(e.data=[e.data])),f(e.fields||[],e.data||[],d);throw Error("Unable to serialize unrecognized input");function f(e,t,i){var o="";"string"==typeof e&&(e=JSON.parse(e)),"string"==typeof t&&(t=JSON.parse(t));var a=Array.isArray(e)&&0<e.length,l=!Array.isArray(t[0]);if(a&&n){for(var d=0;d<e.length;d++)0<d&&(o+=r),o+=m(e[d],d);0<t.length&&(o+=s)}for(var c=0;c<t.length;c++){var h=a?e.length:t[c].length,u=!1,f=a?0===Object.keys(t[c]).length:0===t[c].length;if(i&&!a&&(u="greedy"===i?""===t[c].join("").trim():1===t[c].length&&0===t[c][0].length),"greedy"===i&&a){for(var p=[],g=0;g<h;g++){var _=l?e[g]:g;p.push(t[c][_])}u=""===p.join("").trim()}if(!u){for(var y=0;y<h;y++){0<y&&!f&&(o+=r);var v=a&&l?e[y]:y;o+=m(t[c][v],y)}c<t.length-1&&(!i||0<h&&!f)&&(o+=s)}}return o}function m(e,t){if(null==e)return"";if(e.constructor===Date)return JSON.stringify(e).slice(1,25);var n=!1;h&&"string"==typeof e&&h.test(e)&&(e="'"+e,n=!0);var s=e.toString().replace(u,l);return(n=n||!0===i||"function"==typeof i&&i(e,t)||Array.isArray(i)&&i[t]||function(e,t){for(var i=0;i<t.length;i++)if(-1<e.indexOf(t[i]))return!0;return!1}(s,o.BAD_DELIMITERS)||-1<s.indexOf(r)||" "===s.charAt(0)||" "===s.charAt(s.length-1))?a+s+a:s}}};if(o.RECORD_SEP="\x1e",o.UNIT_SEP="\x1f",o.BYTE_ORDER_MARK="\uFEFF",o.BAD_DELIMITERS=["\r","\n",'"',o.BYTE_ORDER_MARK],o.WORKERS_SUPPORTED=!i&&!!t.Worker,o.NODE_STREAM_INPUT=1,o.LocalChunkSize=10485760,o.RemoteChunkSize=5242880,o.DefaultDelimiter=",",o.Parser=m,o.ParserHandle=f,o.NetworkStreamer=d,o.FileStreamer=c,o.StringStreamer=h,o.ReadableStreamStreamer=u,t.jQuery){var a=t.jQuery;a.fn.parse=function(e){var i=e.config||{},n=[];return this.each(function(e){if(!("INPUT"===a(this).prop("tagName").toUpperCase()&&"file"===a(this).attr("type").toLowerCase()&&t.FileReader)||!this.files||0===this.files.length)return!0;for(var r=0;r<this.files.length;r++)n.push({file:this.files[r],inputElem:this,instanceConfig:a.extend({},i)})}),r(),this;function r(){if(0!==n.length){var t,i,r,l=n[0];if(w(e.before)){var d=e.before(l.file,l.inputElem);if("object"==typeof d){if("abort"===d.action)return t=l.file,i=l.inputElem,r=d.reason,void(w(e.error)&&e.error({name:"AbortError"},t,i,r));if("skip"===d.action)return void s();"object"==typeof d.config&&(l.instanceConfig=a.extend(l.instanceConfig,d.config))}else if("skip"===d)return void s()}var c=l.instanceConfig.complete;l.instanceConfig.complete=function(e){w(c)&&c(e,l.file,l.inputElem),s()},o.parse(l.file,l.instanceConfig)}else w(e.complete)&&e.complete()}function s(){n.splice(0,1),r()}}}function l(e){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(e){var t=v(e);t.chunkSize=parseInt(t.chunkSize),e.step||e.chunk||(t.chunkSize=null),this._handle=new f(t),(this._handle.streamer=this)._config=t}).call(this,e),this.parseChunk=function(e,i){if(this.isFirstChunk&&w(this._config.beforeFirstChunk)){var r=this._config.beforeFirstChunk(e);void 0!==r&&(e=r)}this.isFirstChunk=!1,this._halted=!1;var s=this._partialLine+e;this._partialLine="";var a=this._handle.parse(s,this._baseIndex,!this._finished);if(!this._handle.paused()&&!this._handle.aborted()){var l=a.meta.cursor;this._finished||(this._partialLine=s.substring(l-this._baseIndex),this._baseIndex=l),a&&a.data&&(this._rowCount+=a.data.length);var d=this._finished||this._config.preview&&this._rowCount>=this._config.preview;if(n)t.postMessage({results:a,workerId:o.WORKER_ID,finished:d});else if(w(this._config.chunk)&&!i){if(this._config.chunk(a,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);a=void 0,this._completeResults=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(a.data),this._completeResults.errors=this._completeResults.errors.concat(a.errors),this._completeResults.meta=a.meta),this._completed||!d||!w(this._config.complete)||a&&a.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),d||a&&a.meta.paused||this._nextChunk(),a}this._halted=!0},this._sendError=function(e){w(this._config.error)?this._config.error(e):n&&this._config.error&&t.postMessage({workerId:o.WORKER_ID,error:e,finished:!1})}}function d(e){var t;(e=e||{}).chunkSize||(e.chunkSize=o.RemoteChunkSize),l.call(this,e),this._nextChunk=i?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(e){this._input=e,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(t=new XMLHttpRequest,this._config.withCredentials&&(t.withCredentials=this._config.withCredentials),i||(t.onload=x(this._chunkLoaded,this),t.onerror=x(this._chunkError,this)),t.open(this._config.downloadRequestBody?"POST":"GET",this._input,!i),this._config.downloadRequestHeaders){var e=this._config.downloadRequestHeaders;for(var n in e)t.setRequestHeader(n,e[n])}if(this._config.chunkSize){var r=this._start+this._config.chunkSize-1;t.setRequestHeader("Range","bytes="+this._start+"-"+r)}try{t.send(this._config.downloadRequestBody)}catch(e){this._chunkError(e.message)}i&&0===t.status&&this._chunkError()}},this._chunkLoaded=function(){var e;4===t.readyState&&(t.status<200||400<=t.status?this._chunkError():(this._start+=this._config.chunkSize?this._config.chunkSize:t.responseText.length,this._finished=!this._config.chunkSize||this._start>=(null===(e=t.getResponseHeader("Content-Range"))?-1:parseInt(e.substring(e.lastIndexOf("/")+1))),this.parseChunk(t.responseText)))},this._chunkError=function(e){var i=t.statusText||e;this._sendError(Error(i))}}function c(e){(e=e||{}).chunkSize||(e.chunkSize=o.LocalChunkSize),l.call(this,e);var t,i,n="undefined"!=typeof FileReader;this.stream=function(e){this._input=e,i=e.slice||e.webkitSlice||e.mozSlice,n?((t=new FileReader).onload=x(this._chunkLoaded,this),t.onerror=x(this._chunkError,this)):t=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var e=this._input;if(this._config.chunkSize){var r=Math.min(this._start+this._config.chunkSize,this._input.size);e=i.call(e,this._start,r)}var s=t.readAsText(e,this._config.encoding);n||this._chunkLoaded({target:{result:s}})},this._chunkLoaded=function(e){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(e.target.result)},this._chunkError=function(){this._sendError(t.error)}}function h(e){var t;l.call(this,e=e||{}),this.stream=function(e){return t=e,this._nextChunk()},this._nextChunk=function(){if(!this._finished){var e,i=this._config.chunkSize;return i?(e=t.substring(0,i),t=t.substring(i)):(e=t,t=""),this._finished=!t,this.parseChunk(e)}}}function u(e){l.call(this,e=e||{});var t=[],i=!0,n=!1;this.pause=function(){l.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){l.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(e){this._input=e,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){n&&1===t.length&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),t.length?this.parseChunk(t.shift()):i=!0},this._streamData=x(function(e){try{t.push("string"==typeof e?e:e.toString(this._config.encoding)),i&&(i=!1,this._checkIsFinished(),this.parseChunk(t.shift()))}catch(e){this._streamError(e)}},this),this._streamError=x(function(e){this._streamCleanUp(),this._sendError(e)},this),this._streamEnd=x(function(){this._streamCleanUp(),n=!0,this._streamData("")},this),this._streamCleanUp=x(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function f(e){var t,i,n,r=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,s=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,a=this,l=0,d=0,c=!1,h=!1,u=[],f={data:[],errors:[],meta:{}};if(w(e.step)){var g=e.step;e.step=function(t){if(f=t,x())y();else{if(y(),0===f.data.length)return;l+=t.data.length,e.preview&&l>e.preview?i.abort():(f.data=f.data[0],g(f,a))}}}function _(t){return"greedy"===e.skipEmptyLines?""===t.join("").trim():1===t.length&&0===t[0].length}function y(){return f&&n&&(b("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+o.DefaultDelimiter+"'"),n=!1),e.skipEmptyLines&&(f.data=f.data.filter(function(e){return!_(e)})),x()&&function(){if(f){if(Array.isArray(f.data[0])){for(var t=0;x()&&t<f.data.length;t++)f.data[t].forEach(i);f.data.splice(0,1)}else f.data.forEach(i)}function i(t,i){w(e.transformHeader)&&(t=e.transformHeader(t,i)),u.push(t)}}(),function(){if(!f||!e.header&&!e.dynamicTyping&&!e.transform)return f;function t(t,i){var n,o=e.header?{}:[];for(n=0;n<t.length;n++){var a,l,c=n,h=t[n];e.header&&(c=n>=u.length?"__parsed_extra":u[n]),e.transform&&(h=e.transform(h,c)),a=c,l=h,e.dynamicTypingFunction&&void 0===e.dynamicTyping[a]&&(e.dynamicTyping[a]=e.dynamicTypingFunction(a)),h=!0===(e.dynamicTyping[a]||e.dynamicTyping)?"true"===l||"TRUE"===l||"false"!==l&&"FALSE"!==l&&(!function(e){if(r.test(e)){var t=parseFloat(e);if(-9007199254740992<t&&t<9007199254740992)return!0}return!1}(l)?s.test(l)?new Date(l):""===l?null:l:parseFloat(l)):l,"__parsed_extra"===c?(o[c]=o[c]||[],o[c].push(h)):o[c]=h}return e.header&&(n>u.length?b("FieldMismatch","TooManyFields","Too many fields: expected "+u.length+" fields but parsed "+n,d+i):n<u.length&&b("FieldMismatch","TooFewFields","Too few fields: expected "+u.length+" fields but parsed "+n,d+i)),o}var i=1;return!f.data.length||Array.isArray(f.data[0])?(f.data=f.data.map(t),i=f.data.length):f.data=t(f.data,0),e.header&&f.meta&&(f.meta.fields=u),d+=i,f}()}function x(){return e.header&&0===u.length}function b(e,t,i,n){var r={type:e,code:t,message:i};void 0!==n&&(r.row=n),f.errors.push(r)}this.parse=function(r,s,a){var l=e.quoteChar||'"';if(e.newline||(e.newline=function(e,t){e=e.substring(0,1048576);var i=RegExp(p(t)+"([^]*?)"+p(t),"gm"),n=(e=e.replace(i,"")).split("\r"),r=e.split("\n"),s=1<r.length&&r[0].length<n[0].length;if(1===n.length||s)return"\n";for(var o=0,a=0;a<n.length;a++)"\n"===n[a][0]&&o++;return o>=n.length/2?"\r\n":"\r"}(r,l)),n=!1,e.delimiter)w(e.delimiter)&&(e.delimiter=e.delimiter(r),f.meta.delimiter=e.delimiter);else{var d=function(t,i,n,r,s){var a,l,d,c;s=s||[",","	","|",";",o.RECORD_SEP,o.UNIT_SEP];for(var h=0;h<s.length;h++){var u=s[h],f=0,p=0,g=0;d=void 0;for(var y=new m({comments:r,delimiter:u,newline:i,preview:10}).parse(t),v=0;v<y.data.length;v++)if(n&&_(y.data[v]))g++;else{var x=y.data[v].length;p+=x,void 0!==d?0<x&&(f+=Math.abs(x-d),d=x):d=x}0<y.data.length&&(p/=y.data.length-g),(void 0===l||f<=l)&&(void 0===c||c<p)&&1.99<p&&(l=f,a=u,c=p)}return{successful:!!(e.delimiter=a),bestDelimiter:a}}(r,e.newline,e.skipEmptyLines,e.comments,e.delimitersToGuess);d.successful?e.delimiter=d.bestDelimiter:(n=!0,e.delimiter=o.DefaultDelimiter),f.meta.delimiter=e.delimiter}var h=v(e);return e.preview&&e.header&&h.preview++,t=r,f=(i=new m(h)).parse(t,s,a),y(),c?{meta:{paused:!0}}:f||{meta:{paused:!1}}},this.paused=function(){return c},this.pause=function(){c=!0,i.abort(),t=w(e.chunk)?"":t.substring(i.getCharIndex())},this.resume=function(){a.streamer._halted?(c=!1,a.streamer.parseChunk(t,!0)):setTimeout(a.resume,3)},this.aborted=function(){return h},this.abort=function(){h=!0,i.abort(),f.meta.aborted=!0,w(e.complete)&&e.complete(f),t=""}}function p(e){return e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(e){var t,i=(e=e||{}).delimiter,n=e.newline,r=e.comments,s=e.step,a=e.preview,l=e.fastMode,d=t=void 0===e.quoteChar||null===e.quoteChar?'"':e.quoteChar;if(void 0!==e.escapeChar&&(d=e.escapeChar),("string"!=typeof i||-1<o.BAD_DELIMITERS.indexOf(i))&&(i=","),r===i)throw Error("Comment character same as delimiter");!0===r?r="#":("string"!=typeof r||-1<o.BAD_DELIMITERS.indexOf(r))&&(r=!1),"\n"!==n&&"\r"!==n&&"\r\n"!==n&&(n="\n");var c=0,h=!1;this.parse=function(o,u,f){if("string"!=typeof o)throw Error("Input must be a string");var m=o.length,g=i.length,_=n.length,y=r.length,v=w(s),x=[],b=[],k=[],E=c=0;if(!o)return G();if(e.header&&!u){var R=o.split(n)[0].split(i),C=[],S={},T=!1;for(var O in R){var I=R[O];w(e.transformHeader)&&(I=e.transformHeader(I,O));var A=I,N=S[I]||0;for(0<N&&(T=!0,A=I+"_"+N),S[I]=N+1;C.includes(A);)A=A+"_"+N;C.push(A)}if(T){var j=o.split(n);j[0]=C.join(i),o=j.join(n)}}if(l||!1!==l&&-1===o.indexOf(t)){for(var D=o.split(n),L=0;L<D.length;L++){if(c+=(k=D[L]).length,L!==D.length-1)c+=n.length;else if(f)break;if(!r||k.substring(0,y)!==r){if(v){if(x=[],K(k.split(i)),J(),h)return G()}else K(k.split(i));if(a&&a<=L)return x=x.slice(0,a),G(!0)}}return G()}for(var F=o.indexOf(i,c),z=o.indexOf(n,c),B=RegExp(p(d)+p(t),"g"),M=o.indexOf(t,c);;)if(o[c]!==t){if(r&&0===k.length&&o.substring(c,c+y)===r){if(-1===z)return G();c=z+_,z=o.indexOf(n,c),F=o.indexOf(i,c)}else if(-1!==F&&(F<z||-1===z))k.push(o.substring(c,F)),c=F+g,F=o.indexOf(i,c);else{if(-1===z)break;if(k.push(o.substring(c,z)),W(z+_),v&&(J(),h))return G();if(a&&x.length>=a)return G(!0)}}else for(M=c,c++;;){if(-1===(M=o.indexOf(t,M+1)))return f||b.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:x.length,index:c}),H();if(M===m-1)return H(o.substring(c,M).replace(B,t));if(t!==d||o[M+1]!==d){if(t===d||0===M||o[M-1]!==d){-1!==F&&F<M+1&&(F=o.indexOf(i,M+1)),-1!==z&&z<M+1&&(z=o.indexOf(n,M+1));var P=q(-1===z?F:Math.min(F,z));if(o.substr(M+1+P,g)===i){k.push(o.substring(c,M).replace(B,t)),o[c=M+1+P+g]!==t&&(M=o.indexOf(t,c)),F=o.indexOf(i,c),z=o.indexOf(n,c);break}var U=q(z);if(o.substring(M+1+U,M+1+U+_)===n){if(k.push(o.substring(c,M).replace(B,t)),W(M+1+U+_),F=o.indexOf(i,c),M=o.indexOf(t,c),v&&(J(),h))return G();if(a&&x.length>=a)return G(!0);break}b.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:x.length,index:c}),M++}}else M++}return H();function K(e){x.push(e),E=c}function q(e){var t=0;if(-1!==e){var i=o.substring(M+1,e);i&&""===i.trim()&&(t=i.length)}return t}function H(e){return f||(void 0===e&&(e=o.substring(c)),k.push(e),c=m,K(k),v&&J()),G()}function W(e){c=e,K(k),k=[],z=o.indexOf(n,c)}function G(e){return{data:x,errors:b,meta:{delimiter:i,linebreak:n,aborted:h,truncated:!!e,cursor:E+(u||0)}}}function J(){s(G()),x=[],b=[]}},this.abort=function(){h=!0},this.getCharIndex=function(){return c}}function g(e){var t=e.data,i=r[t.workerId],n=!1;if(t.error)i.userError(t.error,t.file);else if(t.results&&t.results.data){var s={abort:function(){n=!0,_(t.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:y,resume:y};if(w(i.userStep)){for(var o=0;o<t.results.data.length&&(i.userStep({data:t.results.data[o],errors:t.results.errors,meta:t.results.meta},s),!n);o++);delete t.results}else w(i.userChunk)&&(i.userChunk(t.results,s,t.file),delete t.results)}t.finished&&!n&&_(t.workerId,t.results)}function _(e,t){var i=r[e];w(i.userComplete)&&i.userComplete(t),i.terminate(),delete r[e]}function y(){throw Error("Not implemented.")}function v(e){if("object"!=typeof e||null===e)return e;var t=Array.isArray(e)?[]:{};for(var i in e)t[i]=v(e[i]);return t}function x(e,t){return function(){e.apply(t,arguments)}}function w(e){return"function"==typeof e}return n&&(t.onmessage=function(e){var i=e.data;if(void 0===o.WORKER_ID&&i&&(o.WORKER_ID=i.workerId),"string"==typeof i.input)t.postMessage({workerId:o.WORKER_ID,results:o.parse(i.input,i.config),finished:!0});else if(t.File&&i.input instanceof File||i.input instanceof Object){var n=o.parse(i.input,i.config);n&&t.postMessage({workerId:o.WORKER_ID,results:n,finished:!0})}}),(d.prototype=Object.create(l.prototype)).constructor=d,(c.prototype=Object.create(l.prototype)).constructor=c,(h.prototype=Object.create(h.prototype)).constructor=h,(u.prototype=Object.create(l.prototype)).constructor=u,o})?i.apply(t,[]):i)&&(e.exports=n)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=5557)}),_N_E=e.O()}]);